# 审计沟通利器

专业、高效、有理有据的AI驱动审计沟通工具

## 🎯 项目概述

这是一个基于Next.js 14的AI驱动审计沟通工具，帮助审计人员快速生成专业、有理有据的回复内容，提高沟通效率。

## ✨ 核心功能

### 💬 智能沟通生成
- **输入对方话语**：支持文字输入和语音识别
- **调整语气强度**：1-10级可调节的语气强烈程度
- **AI智能回复**：基于GPT-4的专业审计回复生成
- **历史记录**：保存所有沟通记录，支持回顾和参考

### 🎤 语音功能（已完美修复）
- **语音输入**：点击麦克风图标开始语音识别
- **实时识别**：边说边显示识别结果
- **自动添加**：停顿2秒后自动添加到输入框
- **语音播放**：支持播放输入内容和AI回复
- **浏览器兼容**：支持Chrome、Edge、Safari等现代浏览器

### 🎨 语音命令控制
支持以下语音命令：
- **"开始沟通"** - 生成AI回复
- **"清空输入"** - 清除输入内容  
- **"增强语气"** - 提高语气强度
- **"减弱语气"** - 降低语气强度

### 🔧 技术特性
- **Next.js 14 App Router** - 最新的React框架
- **TypeScript** - 类型安全的开发体验
- **Tailwind CSS** - 现代化的UI设计
- **Shadcn/ui组件** - 高质量的UI组件库
- **Web Speech API** - 原生浏览器语音识别

## 🚀 快速开始

### 环境要求
- Node.js 18+ 
- npm或yarn包管理器
- 现代浏览器（推荐Chrome、Edge、Safari）

### 安装步骤

1. **克隆项目**
```bash
git clone <项目地址>
cd audit-chat
```

2. **安装依赖**
```bash
npm install
```

3. **配置环境变量**
复制`.env.example`为`.env.local`并配置：
```bash
OPENAI_API_KEY=your_openai_api_key_here
```

4. **启动开发服务器**
```bash
npm run dev
```

5. **访问应用**
打开浏览器访问：http://localhost:3000

## 📱 使用指南

### 基本操作
1. **输入对方话语**：在文本框中输入或使用语音输入
2. **调整语气强度**：拖动滑块设置1-10的强度级别
3. **生成回复**：点击"开始沟通"按钮
4. **查看结果**：AI生成的专业回复会显示在下方

### 语音功能使用
1. **语音输入**：
   - 点击麦克风图标开始录音
   - 清晰地说出内容
   - 停顿2秒后自动添加到输入框
   - 再次点击可停止录音

2. **语音播放**：
   - 点击"播放"按钮播放输入内容
   - 点击AI回复旁的播放按钮播放回复内容

3. **语音命令**：
   - 使用语音命令面板快速操作
   - 支持"开始沟通"、"清空输入"等命令

## 🔧 技术实现

### 语音识别系统
- **Web Speech API**：使用浏览器原生语音识别
- **实时转换**：边说边显示识别结果
- **智能延迟**：2秒延迟确保完整句子
- **错误处理**：完善的权限和错误处理机制

### AI回复生成
- **GPT-4集成**：使用OpenAI最新模型
- **上下文理解**：结合语气强度生成适当回复
- **专业术语**：针对审计场景优化的回复模板

### 性能优化
- **Server Components**：优先使用服务器组件
- **客户端缓存**：智能缓存用户输入历史
- **响应式设计**：适配各种设备屏幕

## 📋 项目结构

```
audit-chat/
├── app/                    # Next.js 14 App Router
│   ├── layout.tsx         # 根布局
│   ├── page.tsx          # 主页面
│   └── globals.css       # 全局样式
├── components/            # React组件
│   ├── ui/               # Shadcn/ui基础组件
│   ├── communication-tool.tsx  # 主要沟通工具
│   ├── input-form.tsx    # 输入表单组件
│   ├── response-list.tsx # 回复列表组件
│   └── voice-commands.tsx # 语音命令面板
├── hooks/                # 自定义Hook
│   ├── use-speech-recognition.ts # 语音识别Hook
│   ├── use-voice-commands.ts    # 语音命令Hook
│   └── use-toast.ts      # 消息提示Hook
├── lib/                  # 工具库
│   ├── api.ts           # API接口
│   └── utils.ts         # 通用工具函数
└── types/               # TypeScript类型定义
    └── index.ts
```

## 🐛 问题排查

### 语音功能问题
1. **无法启动语音识别**
   - 检查浏览器是否支持（推荐Chrome/Edge）
   - 确认麦克风权限已授权
   - 确保使用HTTPS连接（本地开发除外）

2. **识别准确率低**
   - 确保环境安静，清晰发音
   - 检查麦克风设备是否正常
   - 尝试调整说话音量和语速

3. **文字没有添加到输入框**
   - 查看浏览器控制台错误信息
   - 确认Hook系统正常初始化
   - 检查React状态更新是否正常

### 常见错误解决
- **模块找不到**：运行`npm install`重新安装依赖
- **API调用失败**：检查OpenAI API密钥配置
- **页面无法加载**：确认Node.js版本满足要求

## 🔄 更新日志

### v1.2.0 (最新) - 语音功能完善
- ✅ 修复语音识别Hook系统bug
- ✅ 优化语音识别实例管理
- ✅ 完善错误处理和调试日志
- ✅ 改进语音命令响应速度
- ✅ 增强浏览器兼容性

### v1.1.0 - 语音功能增强
- ✅ 添加语音输入功能
- ✅ 实现语音播放功能  
- ✅ 集成语音命令控制
- ✅ 优化用户界面体验

### v1.0.0 - 基础版本
- ✅ AI驱动的沟通回复生成
- ✅ 语气强度调节功能
- ✅ 历史记录保存
- ✅ 响应式UI设计

## 📄 许可证

本项目采用MIT许可证 - 查看[LICENSE](LICENSE)文件了解详情

## 🤝 贡献指南

欢迎提交Issue和Pull Request来改进这个项目！

---

**专业、高效、有理有据** - 让审计沟通更加轻松！ 🚀 