# 审计沟通利器

## 项目简介
这是一个专为审计师设计的智能沟通工具，帮助审计师在与被审计单位沟通时生成专业、恰当的回复建议。现在支持语音输入功能，让审计师可以快速将对话内容录入系统。

## 功能特性

### 已实现功能
- **文字输入**: 支持手动输入对方的话
- **语音输入**: 🎤 支持语音识别，快速将语音转换为文字
- **语音播放**: 🔊 支持将生成的回复转换为语音播放
- **语音命令**: 🎯 支持语音命令控制应用操作
- **语气强度调节**: 通过滑块调节回复的语气强烈程度（1-10级）
- **智能回复生成**: 基于AI生成多种专业回复建议
- **实时流式输出**: 支持实时显示生成过程
- **历史记录**: 自动保存最近10条沟通记录到本地存储
- **响应式设计**: 适配不同设备屏幕

### 语音功能详解

#### 1. 语音输入 🎤
- **启动方式**: 点击输入框右侧的麦克风图标
- **使用方法**: 
  - 点击麦克风图标开始录音
  - 说话时系统会实时显示识别的文字（蓝色显示）
  - 停顿3秒后自动停止录音并将文字添加到输入框
  - 再次点击可以继续添加内容
- **视觉反馈**: 录音时输入框边框变蓝，显示"正在识别语音..."状态

#### 2. 语音播放 🔊
- **输入内容播放**: 点击输入框上方的"播放"按钮
- **回复播放**: 每个生成的回复都有独立的播放按钮
- **播放控制**: 播放中可以点击"停止播放"按钮中断
- **播放提示**: 播放时会显示浮动提示框

#### 3. 语音命令控制 🎯
- **启动方式**: 点击顶部语音命令面板中的"语音命令"按钮
- **支持命令**:
  - 🗣️ **"开始沟通"** / "开始" / "生成回复" / "提交" → 开始生成AI回复
  - 🗣️ **"清空输入"** / "清空" / "清除" / "删除" / "重置" → 清空输入内容
  - 🗣️ **"增强语气"** / "强烈一点" / "语气强一点" → 增加语气强度
  - 🗣️ **"减弱语气"** / "温和一点" / "语气轻一点" → 降低语气强度
- **使用技巧**: 说话清晰，命令识别成功后会显示执行结果

## 技术栈
- **框架**: Next.js 14 (App Router)
- **UI组件**: Radix UI + Tailwind CSS
- **AI集成**: OpenAI API
- **语音识别**: Web Speech API (SpeechRecognition)
- **语音合成**: Web Speech Synthesis API
- **状态管理**: React Hooks
- **类型检查**: TypeScript

## 项目结构
```
├── app/                    # Next.js 14 App Router
│   ├── globals.css        # 全局样式
│   ├── layout.tsx         # 根布局
│   └── page.tsx           # 主页面
├── components/            # React组件
│   ├── ui/               # 基础UI组件
│   ├── communication-tool.tsx  # 主要沟通工具组件
│   ├── input-form.tsx    # 输入表单组件（带语音功能）
│   ├── response-list.tsx # 回复列表组件（带语音播放）
│   └── header.tsx        # 页头组件
├── hooks/                # 自定义Hooks
│   ├── use-speech-recognition.ts  # 语音识别Hook
│   ├── use-voice-commands.ts      # 语音命令Hook
│   └── use-toast.ts      # 通知Hook
├── lib/                  # 工具函数和API
└── README.md            # 项目说明

```

## 快速开始

### 安装依赖
```bash
npm install
```

### 启动开发服务器
```bash
npm run dev
```

### 构建生产版本
```bash
npm run build
```

## 使用说明

### 基础功能
1. **输入对方的话**: 在文本框中输入被审计单位人员的话
2. **调节语气强度**: 使用滑块选择回复的语气强烈程度
3. **生成回复**: 点击"开始沟通"按钮生成AI回复建议
4. **查看建议**: 系统会生成多个专业回复选项供选择

### 语音功能使用指南

#### 📱 移动端使用
- 确保允许浏览器访问麦克风权限
- 在安静环境中使用语音功能效果更佳
- 支持中文普通话识别

#### 🖥️ 桌面端使用
- 推荐使用Chrome、Edge、Safari等现代浏览器
- 首次使用需要授权麦克风权限
- 支持快捷键操作（开发中）

#### 🎯 语音命令最佳实践
1. **环境要求**: 在相对安静的环境中使用
2. **发音清晰**: 语速适中，发音清晰
3. **命令简洁**: 使用支持的关键词组合
4. **等待反馈**: 命令执行后等待系统反馈

### 实际使用场景

#### 场景1: 审计访谈记录
```
审计师：[启动语音输入]
被审计单位："我们公司的内控制度都很完善，没有什么问题"
系统：[自动识别并转换为文字]
审计师：[语音命令] "开始沟通"
系统：[生成专业回复建议]
审计师：[点击播放按钮听取回复]
```

#### 场景2: 快速记录关键信息
```
审计师：[边听对方说话，边使用语音输入记录]
被审计单位："这笔费用是去年12月份的差旅费，大概10万元左右"
审计师：[语音命令] "增强语气" [调整回复强度]
审计师：[语音命令] "开始沟通" [生成回复]
```

## 配置说明

### 环境变量
在项目根目录创建 `.env.local` 文件：
```env
OPENAI_API_KEY=your_openai_api_key_here
```

### 浏览器兼容性
语音功能需要浏览器支持：

#### ✅ 完全支持
- **Chrome** 60+ (推荐)
- **Edge** 79+
- **Safari** 14.1+

#### ⚠️ 部分支持
- **Firefox**: 语音合成支持，语音识别支持有限
- **移动端Safari**: iOS 14.5+
- **移动端Chrome**: Android 5.0+

#### ❌ 不支持
- IE浏览器
- 旧版本浏览器

### 权限设置
使用语音功能需要以下权限：
1. **麦克风权限**: 用于语音输入和语音命令
2. **媒体权限**: 用于语音播放
3. **通知权限**: 用于功能反馈（可选）

## 故障排除

### 常见问题

#### Q: 语音识别不工作？
**A**: 检查以下几点：
- 浏览器是否支持语音识别
- 是否已授权麦克风权限
- 网络连接是否正常
- 麦克风设备是否正常工作

#### Q: 语音播放没有声音？
**A**: 检查以下几点：
- 设备音量是否开启
- 浏览器是否静音
- 是否支持语音合成功能

#### Q: 语音命令识别不准确？
**A**: 尝试以下方法：
- 在安静环境中使用
- 说话清晰，语速适中
- 使用标准普通话
- 靠近麦克风设备

#### Q: 权限被拒绝？
**A**: 重新设置权限：
1. 点击浏览器地址栏的锁形图标
2. 允许麦克风权限
3. 刷新页面重试

## 更新日志

### v0.2.0 (当前版本)
- ✨ 新增语音输入功能
- ✨ 新增语音播放功能
- ✨ 新增语音命令控制
- ✨ 新增实时语音识别状态显示
- ✨ 新增浏览器兼容性检查
- 🎨 优化用户界面体验
- 📱 增强移动端适配
- 🔊 添加音频反馈和提示
- 🎯 支持多种语音命令关键词

### v0.1.0 (已发布)
- ✨ 基础文字输入功能
- ✨ AI回复生成
- ✨ 语气强度调节
- ✨ 实时流式输出
- ✨ 历史记录保存

## 开发者信息
- 开发框架: Next.js 14
- 开发时间: 2024年
- 维护状态: 积极维护中

## 许可证
私有项目，版权所有。 